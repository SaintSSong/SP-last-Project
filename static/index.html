<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Chat</title>
</head>

<body>
    <h1>WebSocket Chat</h1>

    <div>
        <label for="user1Id">User 1 ID:</label>
        <input type="number" id="user1Id">
    </div>
    <div>
        <label for="user2Id">User 2 ID:</label>
        <input type="number" id="user2Id">
    </div>
    <button id="createRoomButton">Create Chat Room</button>

    <div>
        <label for="joinUserId">User ID:</label>
        <input type="number" id="joinUserId">
    </div>
    <div>
        <label for="joinRoomId">Room Id:</label>
        <input type="number" id="joinRoomId">
    </div>
    <button id="joinRoomButton">Join Chat Room</button>
    <br>

    <div>
        <label for="exitUserId">User ID:</label>
        <input type="number" id="exitUserId">
    </div>
    <div>
        <label for="exitRoomId">Room Id:</label>
        <input type="number" id="exitRoomId">
    </div>
    <button id="exitRoomButton">Exit Chat Room</button>
    <br>

    <div>
        <label for="sendRoomId">Room ID:</label>
        <input type="number" id="sendRoomId">
    </div>
    <div>
        <label for="sendUserId">User ID:</label>
        <input type="number" id="sendUserId">
    </div>
    <div>
        <label for="message">Message:</label>
        <input type="text" id="message">
    </div>
    <button id="sendMessageButton">Send Message</button>
    <ul id="messages"></ul>

    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <script>
        const socket = io('ws://localhost:3000/chat');
        const token = ''
        const createRoomButton = document.getElementById('createRoomButton');
        const sendMessageButton = document.getElementById('sendMessageButton');
        const joinRoomButton = document.getElementById('joinRoomButton');
        const exitRoomButton = document.getElementById('exitRoomButton');
        const messagesList = document.getElementById('messages');

        createRoomButton.addEventListener('click', () => {
            const user1Id = document.getElementById('user1Id').value;
            const user2Id = document.getElementById('user2Id').value;
            socket.emit('createdChatRoom', { user1Id: Number(user1Id), user2Id: Number(user2Id) });
        });

        joinRoomButton.addEventListener('click', () => {
            const userId = document.getElementById('joinUserId').value;
            const roomId = document.getElementById('joinRoomId').value;
            socket.emit('join', { userId: Number(userId), roomId: Number(roomId) });
        });

        sendMessageButton.addEventListener('click', () => {
            const roomId = document.getElementById('sendRoomId').value;
            const userId = document.getElementById('sendUserId').value;
            const message = document.getElementById('message').value;
            socket.emit('message', { roomId: Number(roomId), userId: Number(userId), message: message });
        });

        exitRoomButton.addEventListener('click', () => {
            const roomId = document.getElementById('exitRoomId').value;
            const userId = document.getElementById('exitUserId').value;
            socket.emit('exit', { userId: Number(userId), roomId: Number(roomId) });
        });

        socket.on('createdChatRoom', (chatRoom) => {
            const item = document.createElement('li');
            item.textContent = `Chat room created with ID ${chatRoom.id}`;
            messagesList.appendChild(item);
        });

        socket.on('message', (message) => {
            const item = document.createElement('li');
            console.log(message)
            item.textContent = `User ${message.senderId}: ${message.text}`;
            messagesList.appendChild(item);
        });
    </script>
</body>

</html>